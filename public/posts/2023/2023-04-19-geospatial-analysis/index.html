<!doctype html><html lang=vi dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Geospatial Analysis | The Financial Engineer</title>
<meta name=keywords content="Python,Data Analysis,Geospatial Analysis,Kaggle"><meta name=description content="My Kaggle Learning Note 6"><meta name=author content="Kean Teng Blog"><link rel=canonical href=http://localhost:1313/posts/2023/2023-04-19-geospatial-analysis/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=vi href=http://localhost:1313/posts/2023/2023-04-19-geospatial-analysis/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Geospatial Analysis"><meta property="og:description" content="My Kaggle Learning Note 6"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/2023/2023-04-19-geospatial-analysis/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-19T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-19T00:00:00+00:00"><meta property="og:site_name" content="QHung's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Geospatial Analysis"><meta name=twitter:description content="My Kaggle Learning Note 6"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Geospatial Analysis","item":"http://localhost:1313/posts/2023/2023-04-19-geospatial-analysis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Geospatial Analysis","name":"Geospatial Analysis","description":"My Kaggle Learning Note 6","keywords":["Python","Data Analysis","Geospatial Analysis","Kaggle"],"articleBody":" Disclaimer: This article is my learning note from the courses I took from Kaggle.\nGeospatial analysis is the gathering, display and manipulation of imagery, GPS, satellite photography and historical data, described explicitly in terms of geographic coordinates. This course will learn on methods to visualize geospatial data and perform some analysis concerning a particular geographic location or region.\nSome interesting questions that can be addressed with geospatial analysis are:\nWhich areas affected by earthquakes would require additional reinforcement? Where should a popular coffee shop select its next store, if it is considering an expansion? With forest conservation areas set up in some regions, will animals migrate to those areas or other areas instead? 1. Creating Maps To visualize geographic coordinates as a map, we need the help of geopandas library. Note that there are a few geospatial file formats available such as shapefile, GeoJSON, KML and GPKG. But all the files can be loaded with geopandaslibrary:\n1 2 # read the shape file full_data = gpd.read_file(\"file_name\") Here’s how we can create a map for a geospatial data file. In fact, in every GeoDataFrame, there will be a geometry column that describe the geometric objects when we display them with the plot() function. They can be a point, linestring or polygon :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 ## 1. Prework # plot the data only wild_lands.plot() # campsites point POI_data = gpd.read_file(\"../input/geospatial-learn-course-data/DEC_pointsinterest/DEC_pointsinterest/Decptsofinterest.shp\") campsites = POI_data.loc[POI_data.ASSET=='PRIMITIVE CAMPSITE'].copy() # foot trails as linestring roads_trails = gpd.read_file(\"../input/geospatial-learn-course-data/DEC_roadstrails/DEC_roadstrails/Decroadstrails.shp\") trails = roads_trails.loc[roads_trails.ASSET=='FOOT TRAIL'].copy() # country boundaris as polygon counties = gpd.read_file(\"../input/geospatial-learn-course-data/NY_county_boundaries/NY_county_boundaries/NY_county_boundaries.shp\") ## 2. Visualize the map # Plot a base map with counties boundaries ax = counties.plot(figsize=(10,10), color='none', edgecolor='gainsboro', zorder=3) # Add in the campsites and foot trails wild_lands.plot(color='lightgreen', ax=ax) campsites.plot(color='maroon', markersize=2, ax=ax) trails.plot(color='black', markersize=1, ax=ax) 2. Coordinate Reference System In order to create a GeoDataFrame, we have to set the CRS. The CRS is referenced by European Petroleum Survey Group code - EPSG 32630 used by GeoDataFrame or also known as the “Mercator” projection that preserves angles and slightly distorts area. What’s more, EPSG 4326 corresponds to coordinates in latitude and longitude. It is a coordinate system of latitude and longitude based on an ellipsoidal (squashed sphere) model of the earth.\nHere’s how to do it in code:\n1 2 3 4 5 6 7 8 9 10 11 # read file facilities_df = pd. read_csv(\"file_name\") # convert to geodataframe facilities = gpd.GeoDataFrames(facilities_df, geometry = points_from_xy(facilities_df.Longitude, facilities_df.Latitiude)) # set crs facilities.crs = {'init': 'epsg:4326'} # view first five rows facilities.head() It is also possible to change the CRS so that we can have datasets with matching CRS. If we cannot do it with code, alternatively, we can use proj4 string of CRS to convert to latitude and longitude coordinates using +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs:\n1 2 3 4 5 6 # match facilities crs with regions ax = regions.plot(figsize=(8,8), color='whitesmoke', linestyle=':', edgecolor='black') facilities.to_crs(epsg=32630).plot(markersize=1, ax=ax) # change CRS to EPSG 4326 and display the data regions.to_crs(\"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs\").head() 2.1 Geometric Objects Attributes Previously, we introduced the geometry column in a GeoDataFrame, in fact they are built-in attributes that could help to give us some interesting information about our data. For example, we want to find the coordinates of each point, the length of linestring or the area of a polygon.\n1 2 3 4 5 # find points x-coordinate facilities.geometry.head().x # find area of polygons regions.loc[:, \"AREA\"] = regions.geometry.area/ 10**6 3. Interactive Maps In this section, we will explore methods to plot interactive maps such as heatmaps, points and choropleth maps. These features are enabled by the folium package.\nSome maps to plot with folium package:\nSimple Map Markers/ Bubbles Clustered markers Heatmaps Choropleth maps To create a simple map for visualization as follows:\n1 2 3 4 5 # Create a map m_1 = folium.Map(location=[42.32,-71.0589], tiles='openstreetmap', zoom_start=10) # Display the map m_1 Let’s say we want to add some markers to the map. Here’s a case where we add markers to denote places that experienced robbery on the map:\n1 2 3 4 5 6 7 8 9 10 11 12 13 # data preparatin daytime_robberies = crimes[((crimes.OFFENSE_CODE_GROUP == 'Robbery') \u0026 \\ (crimes.HOUR.isin(range(9,18))))] # Create a map m_2 = folium.Map(location=[42.32,-71.0589], tiles='cartodbpositron', zoom_start=13) # Add points to the map for idx, row in daytime_robberies.iterrows(): Marker([row['Lat'], row['Long']]).add_to(m_2) # Display the map m_2 Now notice that the markers are scattered all over the place. It is possible to cluster together the markers when we zoom out the map and let the markers spread out as we zoom in with the help of MarkerCluster():\n1 2 3 4 5 6 7 8 9 10 11 12 # Create the map m_3 = folium.Map(location=[42.32,-71.0589], tiles='cartodbpositron', zoom_start=13) # Add points to the map mc = MarkerCluster() for idx, row in daytime_robberies.iterrows(): if not math.isnan(row['Long']) and not math.isnan(row['Lat']): mc.add_child(Marker([row['Lat'], row['Long']])) m_3.add_child(mc) # Display the map m_3 An alternative to markers on map, we could also use circle for the same purpose - that is bubble maps:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 # Create a base map m_4 = folium.Map(location=[42.32,-71.0589], tiles='cartodbpositron', zoom_start=13) def color_producer(val): if val \u003c= 12: return 'forestgreen' else: return 'darkred' # Add a bubble map to the base map for i in range(0,len(daytime_robberies)): Circle( location=[daytime_robberies.iloc[i]['Lat'], daytime_robberies.iloc[i]['Long']], radius=20, color=color_producer(daytime_robberies.iloc[i]['HOUR'])).add_to(m_4) # Display the map m_4 Now consider that among few cities with different crime rate. We would like to visualize whether which city has relatively more criminal incidents than the other, a heatmap would do a good job to show us which areas of a city are susceptible to more criminal cases:\n1 2 3 4 5 6 7 8 # Create a base map m_5 = folium.Map(location=[42.32,-71.0589], tiles='cartodbpositron', zoom_start=12) # Add a heatmap to the base map HeatMap(data=crimes[['Lat', 'Long']], radius=10).add_to(m_5) # Display the map m_5 Well, you should notice that heatmap makes geographic boundaries between different areas non-distinguishable. We can also use choropleth maps instead to visualize the crime rate by district.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # GeoDataFrame with geographical boundaries of Boston police districts districts_full = gpd.read_file('../input/geospatial-learn-course-data/Police_Districts/Police_Districts/Police_Districts.shp') districts = districts_full[[\"DISTRICT\", \"geometry\"]].set_index(\"DISTRICT\") districts.head() # Number of crimes in each police district plot_dict = crimes.DISTRICT.value_counts() plot_dict.head() # Create a base map m_6 = folium.Map(location=[42.32,-71.0589], tiles='cartodbpositron', zoom_start=12) # Add a choropleth map to the base map Choropleth(geo_data=districts.__geo_interface__, data=plot_dict, key_on=\"feature.id\", fill_color='YlGnBu', legend_name='Major criminal incidents (Jan-Aug 2018)' ).add_to(m_6) # Display the map m_6 4. Manipulating Geospatial Data When we are using application such a Google Maps, we could easily get a place location on the map by just knowing the address or name. In fact, we are using what it’s known as geocoder to generate locations of the places that we want to go.\nHere’s an interesting example where we try to geocode 100 top universities in Europe with only the universities name:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 # 1. prepare a dataset with the universitites name universities = pd.read_csv(\"../input/geospatial-learn-course-data/top_universities.csv\") universities.head() # 2. apply geocode to each of the universitites def my_geocoder(row): try: point = geolocator.geocode(row).point return pd.Series({'Latitude': point.latitude, 'Longitude': point.longitude}) except: return None universities[['Latitude', 'Longitude']] = universities.apply(lambda x: my_geocoder(x['Name']), axis=1) print(\"{}% of addresses were geocoded!\".format( (1 - sum(np.isnan(universities[\"Latitude\"])) / len(universities)) * 100)) # Drop universities that were not successfully geocoded universities = universities.loc[~np.isnan(universities[\"Latitude\"])] universities = gpd.GeoDataFrame( universities, geometry=gpd.points_from_xy(universities.Longitude, universities.Latitude)) universities.crs = {'init': 'epsg:4326'} universities.head() Now let’s plot out the locations to see if they are accurate:\n1 2 3 4 5 6 7 8 9 # Create a map m = folium.Map(location=[54, 15], tiles='openstreetmap', zoom_start=2) # Add points to the map for idx, row in universities.iterrows(): Marker([row['Latitude'], row['Longitude']], popup=row['Name']).add_to(m) # Display the map m 4.1 Table Joins In this section, we will explore on combining data frames with shared index for the case of GeoDataFrame. An example is that we have a dataset with boundaries of every country in Europe and a dataset with their estimated population and GDP, we can perform attribute join to merge the two datasets:\n1 2 europe = europe_boundaries.merge(europe_stats, on=\"name\") europe.head() Furthermore, it is also possible to merge GeoDataFrame based on spatial relationship between objects in geometry columns. Recall back that we geocode top 100 universities in Europe previously. Can we match each university with its corresponding country? Spatial join allow us to perform match for such as scenario.\nThe spatial join above looks at the “geometry” columns in both GeoDataFrames. If a Point object from the universities GeoDataFrame intersects a Polygon object from the europe DataFrame, the corresponding rows are combined and added as a single row of the european_universities DataFrame. Otherwise, countries without a matching university (and universities without a matching country) are omitted from the results.\n1 2 3 4 5 6 7 8 9 # Use spatial join to match universities to countries in Europe european_universities = gpd.sjoin(universities, europe) # Investigate the result print(\"We located {} universities.\".format(len(universities))) print(\"Only {} of the universities were located in Europe (in {} different countries).\".format( len(european_universities), len(european_universities.name.unique()))) european_universities.head() 5. Proximity Analysis For the previous four sections, we are exposed to a lot of the functions in geopandas. Here, we will look into some application areas with the learned functions:\nSome useful application:\nMeasuring distance between points on a map Select points within some radius of a feature To compute distances from two GeoDataFrames, we need to make sure they have the same CRS. The distances can be easily computed in GeoPandas. Moreover, we can find the mean distance between two points with mean too. Here’s an example where we deal with dataset with air quality monitoring stations in the same city where we would like to know the mean distance from one monitoring station to the other:\n1 2 3 4 5 6 7 8 9 10 11 12 13 # check CRS of geodataframes print(stations.crs) print(releases.crs) # Select one release incident in particular recent_release = releases.iloc[360] # Measure distance from release to each station distances = stations.geometry.distance(recent_release.geometry) distances # find the mean distance print('Mean distance to monitoring stations: {} feet'.format(distances.mean())) 5.1 Creating a Buffer The purpose of creating a buffer is for us to understand points on a map that lies some radius away from a point. For example, there’s a toxic gas being release accidentally to the air. There are some air quality monitoring centers nearby. We want to know whether those centers are able to detect the toxic gas.\nA working example would be as follows:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # 1. creating a two miles buffer two_mile_buffer = stations.geometry.buffer(2*5280) two_mile_buffer.head() # 2. create map with release incidents and monitoring stations m = folium.Map(location=[39.9526,-75.1652], zoom_start=11) HeatMap(data=releases[['LATITUDE', 'LONGITUDE']], radius=15).add_to(m) for idx, row in stations.iterrows(): Marker([row['LATITUDE'], row['LONGITUDE']]).add_to(m) # Plot each polygon on the map GeoJson(two_mile_buffer.to_crs(epsg=4326)).add_to(m) # Show the map m Now we want to check if a toxic release occurred within 2 miles of any monitoring station, to do that we would need to test each polygon. But that would be tedious work. Consider combining all the polygons into one object, we can check whether the toxic gas is within the radar of the closest monitoring station:\n1 2 # check if output is true my_union.contains(releases.iloc[360].geometry) ","wordCount":"1906","inLanguage":"vi","datePublished":"2023-04-19T00:00:00Z","dateModified":"2023-04-19T00:00:00Z","author":{"@type":"Person","name":"Kean Teng Blog"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/2023/2023-04-19-geospatial-analysis/"},"publisher":{"@type":"Organization","name":"The Financial Engineer","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="The Financial Engineer (Alt + H)">The Financial Engineer</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/about/ title=About><span>About</span></a></li><li><a href=http://localhost:1313/archives/ title=Archive><span>Archive</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Geospatial Analysis</h1><div class=post-description>My Kaggle Learning Note 6</div><div class=post-meta><span title='2023-04-19 00:00:00 +0000 UTC'>tháng 4 19, 2023</span>&nbsp;·&nbsp;9 phút&nbsp;·&nbsp;Kean Teng Blog</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Mục lục</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-creating-maps>1. Creating Maps</a></li><li><a href=#2-coordinate-reference-system>2. Coordinate Reference System</a><ul><li><a href=#21-geometric-objects-attributes>2.1 Geometric Objects Attributes</a></li></ul></li><li><a href=#3-interactive-maps>3. Interactive Maps</a></li><li><a href=#4-manipulating-geospatial-data>4. Manipulating Geospatial Data</a><ul><li><a href=#41-table-joins>4.1 Table Joins</a></li></ul></li><li><a href=#5-proximity-analysis>5. Proximity Analysis</a><ul><li><a href=#51-creating-a-buffer>5.1 Creating a Buffer</a></li></ul></li></ul></nav></div></details></div><div class=post-content><blockquote><p><em>Disclaimer: This article is my learning note from the courses I took from Kaggle.</em></p></blockquote><p><strong>Geospatial analysis</strong> is the gathering, display and manipulation of imagery, GPS, satellite photography and historical data, described explicitly in terms of geographic coordinates. This course will learn on methods to visualize geospatial data and perform some analysis concerning a particular geographic location or region.</p><p>Some interesting questions that can be addressed with geospatial analysis are:</p><ul><li>Which areas affected by earthquakes would require additional reinforcement?</li><li>Where should a popular coffee shop select its next store, if it is considering an expansion?</li><li>With forest conservation areas set up in some regions, will animals migrate to those areas or other areas instead?</li></ul><h2 id=1-creating-maps>1. Creating Maps<a hidden class=anchor aria-hidden=true href=#1-creating-maps>#</a></h2><p>To visualize geographic coordinates as a map, we need the help of <code>geopandas</code> library. Note that there are a few geospatial file formats available such as <code>shapefile</code>, <code>GeoJSON</code>, <code>KML</code> and <code>GPKG</code>. But all the files can be loaded with <code>geopandas</code>library:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># read the shape file</span>
</span></span><span style=display:flex><span>full_data <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>read_file(<span style=color:#e6db74>&#34;file_name&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>Here&rsquo;s how we can create a map for a geospatial data file. In fact, in every <code>GeoDataFrame</code>, there will be a geometry column that describe the geometric objects when we display them with the <code>plot()</code> function. They can be a point, linestring or polygon :</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e>## 1. Prework</span>
</span></span><span style=display:flex><span><span style=color:#75715e># plot the data only </span>
</span></span><span style=display:flex><span>wild_lands<span style=color:#f92672>.</span>plot()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># campsites point</span>
</span></span><span style=display:flex><span>POI_data <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>read_file(<span style=color:#e6db74>&#34;../input/geospatial-learn-course-data/DEC_pointsinterest/DEC_pointsinterest/Decptsofinterest.shp&#34;</span>)
</span></span><span style=display:flex><span>campsites <span style=color:#f92672>=</span> POI_data<span style=color:#f92672>.</span>loc[POI_data<span style=color:#f92672>.</span>ASSET<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;PRIMITIVE CAMPSITE&#39;</span>]<span style=color:#f92672>.</span>copy()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># foot trails as linestring</span>
</span></span><span style=display:flex><span>roads_trails <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>read_file(<span style=color:#e6db74>&#34;../input/geospatial-learn-course-data/DEC_roadstrails/DEC_roadstrails/Decroadstrails.shp&#34;</span>)
</span></span><span style=display:flex><span>trails <span style=color:#f92672>=</span> roads_trails<span style=color:#f92672>.</span>loc[roads_trails<span style=color:#f92672>.</span>ASSET<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;FOOT TRAIL&#39;</span>]<span style=color:#f92672>.</span>copy()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># country boundaris as polygon</span>
</span></span><span style=display:flex><span>counties <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>read_file(<span style=color:#e6db74>&#34;../input/geospatial-learn-course-data/NY_county_boundaries/NY_county_boundaries/NY_county_boundaries.shp&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 2. Visualize the map</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot a base map with counties boundaries</span>
</span></span><span style=display:flex><span>ax <span style=color:#f92672>=</span> counties<span style=color:#f92672>.</span>plot(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>), color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;none&#39;</span>, edgecolor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;gainsboro&#39;</span>, zorder<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add in the campsites and foot trails</span>
</span></span><span style=display:flex><span>wild_lands<span style=color:#f92672>.</span>plot(color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;lightgreen&#39;</span>, ax<span style=color:#f92672>=</span>ax)
</span></span><span style=display:flex><span>campsites<span style=color:#f92672>.</span>plot(color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;maroon&#39;</span>, markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>, ax<span style=color:#f92672>=</span>ax)
</span></span><span style=display:flex><span>trails<span style=color:#f92672>.</span>plot(color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;black&#39;</span>, markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, ax<span style=color:#f92672>=</span>ax)
</span></span></code></pre></td></tr></table></div></div><h2 id=2-coordinate-reference-system>2. Coordinate Reference System<a hidden class=anchor aria-hidden=true href=#2-coordinate-reference-system>#</a></h2><p>In order to create a <code>GeoDataFrame</code>, we have to set the CRS. The CRS is referenced by European Petroleum Survey Group code - <code>EPSG 32630</code> used by <code>GeoDataFrame</code> or also known as the &ldquo;Mercator&rdquo; projection that preserves angles and slightly distorts area. What&rsquo;s more, <code>EPSG 4326</code> corresponds to coordinates in latitude and longitude. It is a coordinate system of latitude and longitude based on an ellipsoidal (squashed sphere) model of the earth.</p><p>Here&rsquo;s how to do it in code:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># read file</span>
</span></span><span style=display:flex><span>facilities_df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span> read_csv(<span style=color:#e6db74>&#34;file_name&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># convert to geodataframe</span>
</span></span><span style=display:flex><span>facilities <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>GeoDataFrames(facilities_df, geometry <span style=color:#f92672>=</span> points_from_xy(facilities_df<span style=color:#f92672>.</span>Longitude, facilities_df<span style=color:#f92672>.</span>Latitiude))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># set crs</span>
</span></span><span style=display:flex><span>facilities<span style=color:#f92672>.</span>crs <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;init&#39;</span>: <span style=color:#e6db74>&#39;epsg:4326&#39;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># view first five rows</span>
</span></span><span style=display:flex><span>facilities<span style=color:#f92672>.</span>head()
</span></span></code></pre></td></tr></table></div></div><p>It is also possible to change the CRS so that we can have datasets with matching CRS. If we cannot do it with code, alternatively, we can use <code>proj4 string</code> of CRS to convert to latitude and longitude coordinates using <code>+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># match facilities crs with regions</span>
</span></span><span style=display:flex><span>ax <span style=color:#f92672>=</span> regions<span style=color:#f92672>.</span>plot(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>8</span>), color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;whitesmoke&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;:&#39;</span>, edgecolor<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>facilities<span style=color:#f92672>.</span>to_crs(epsg<span style=color:#f92672>=</span><span style=color:#ae81ff>32630</span>)<span style=color:#f92672>.</span>plot(markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, ax<span style=color:#f92672>=</span>ax)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># change CRS to EPSG 4326 and display the data</span>
</span></span><span style=display:flex><span>regions<span style=color:#f92672>.</span>to_crs(<span style=color:#e6db74>&#34;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&#34;</span>)<span style=color:#f92672>.</span>head()
</span></span></code></pre></td></tr></table></div></div><h3 id=21-geometric-objects-attributes>2.1 Geometric Objects Attributes<a hidden class=anchor aria-hidden=true href=#21-geometric-objects-attributes>#</a></h3><p>Previously, we introduced the geometry column in a <code>GeoDataFrame</code>, in fact they are built-in attributes that could help to give us some interesting information about our data. For example, we want to find the coordinates of each point, the length of linestring or the area of a polygon.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># find points x-coordinate</span>
</span></span><span style=display:flex><span>facilities<span style=color:#f92672>.</span>geometry<span style=color:#f92672>.</span>head()<span style=color:#f92672>.</span>x
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># find area of polygons</span>
</span></span><span style=display:flex><span>regions<span style=color:#f92672>.</span>loc[:, <span style=color:#e6db74>&#34;AREA&#34;</span>] <span style=color:#f92672>=</span> regions<span style=color:#f92672>.</span>geometry<span style=color:#f92672>.</span>area<span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span><span style=color:#f92672>**</span><span style=color:#ae81ff>6</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=3-interactive-maps>3. Interactive Maps<a hidden class=anchor aria-hidden=true href=#3-interactive-maps>#</a></h2><p>In this section, we will explore methods to plot interactive maps such as heatmaps, points and choropleth maps. These features are enabled by the <code>folium</code> package.</p><p>Some maps to plot with <code>folium</code> package:</p><ul><li>Simple Map</li><li>Markers/ Bubbles</li><li>Clustered markers</li><li>Heatmaps</li><li>Choropleth maps</li></ul><p>To create a simple map for visualization as follows:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># Create a map</span>
</span></span><span style=display:flex><span>m_1 <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>42.32</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>71.0589</span>], tiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;openstreetmap&#39;</span>, zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display the map</span>
</span></span><span style=display:flex><span>m_1
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s say we want to add some markers to the map. Here&rsquo;s a case where we add markers to denote places that experienced robbery on the map:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># data preparatin</span>
</span></span><span style=display:flex><span>daytime_robberies <span style=color:#f92672>=</span> crimes[((crimes<span style=color:#f92672>.</span>OFFENSE_CODE_GROUP <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Robbery&#39;</span>) <span style=color:#f92672>&amp;</span> \
</span></span><span style=display:flex><span>                            (crimes<span style=color:#f92672>.</span>HOUR<span style=color:#f92672>.</span>isin(range(<span style=color:#ae81ff>9</span>,<span style=color:#ae81ff>18</span>))))]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a map</span>
</span></span><span style=display:flex><span>m_2 <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>42.32</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>71.0589</span>], tiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cartodbpositron&#39;</span>, zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add points to the map</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> idx, row <span style=color:#f92672>in</span> daytime_robberies<span style=color:#f92672>.</span>iterrows():
</span></span><span style=display:flex><span>    Marker([row[<span style=color:#e6db74>&#39;Lat&#39;</span>], row[<span style=color:#e6db74>&#39;Long&#39;</span>]])<span style=color:#f92672>.</span>add_to(m_2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display the map</span>
</span></span><span style=display:flex><span>m_2
</span></span></code></pre></td></tr></table></div></div><p>Now notice that the markers are scattered all over the place. It is possible to cluster together the markers when we zoom out the map and let the markers spread out as we zoom in with the help of <code>MarkerCluster()</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># Create the map</span>
</span></span><span style=display:flex><span>m_3 <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>42.32</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>71.0589</span>], tiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cartodbpositron&#39;</span>, zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add points to the map</span>
</span></span><span style=display:flex><span>mc <span style=color:#f92672>=</span> MarkerCluster()
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> idx, row <span style=color:#f92672>in</span> daytime_robberies<span style=color:#f92672>.</span>iterrows():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> math<span style=color:#f92672>.</span>isnan(row[<span style=color:#e6db74>&#39;Long&#39;</span>]) <span style=color:#f92672>and</span> <span style=color:#f92672>not</span> math<span style=color:#f92672>.</span>isnan(row[<span style=color:#e6db74>&#39;Lat&#39;</span>]):
</span></span><span style=display:flex><span>        mc<span style=color:#f92672>.</span>add_child(Marker([row[<span style=color:#e6db74>&#39;Lat&#39;</span>], row[<span style=color:#e6db74>&#39;Long&#39;</span>]]))
</span></span><span style=display:flex><span>m_3<span style=color:#f92672>.</span>add_child(mc)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display the map</span>
</span></span><span style=display:flex><span>m_3
</span></span></code></pre></td></tr></table></div></div><p>An alternative to markers on map, we could also use circle for the same purpose - that is bubble maps:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># Create a base map</span>
</span></span><span style=display:flex><span>m_4 <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>42.32</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>71.0589</span>], tiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cartodbpositron&#39;</span>, zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>13</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>color_producer</span>(val):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> val <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>12</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;forestgreen&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;darkred&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add a bubble map to the base map</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>,len(daytime_robberies)):
</span></span><span style=display:flex><span>    Circle(
</span></span><span style=display:flex><span>        location<span style=color:#f92672>=</span>[daytime_robberies<span style=color:#f92672>.</span>iloc[i][<span style=color:#e6db74>&#39;Lat&#39;</span>], daytime_robberies<span style=color:#f92672>.</span>iloc[i][<span style=color:#e6db74>&#39;Long&#39;</span>]],
</span></span><span style=display:flex><span>        radius<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>,
</span></span><span style=display:flex><span>        color<span style=color:#f92672>=</span>color_producer(daytime_robberies<span style=color:#f92672>.</span>iloc[i][<span style=color:#e6db74>&#39;HOUR&#39;</span>]))<span style=color:#f92672>.</span>add_to(m_4)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display the map</span>
</span></span><span style=display:flex><span>m_4
</span></span></code></pre></td></tr></table></div></div><p>Now consider that among few cities with different crime rate. We would like to visualize whether which city has relatively more criminal incidents than the other, a heatmap would do a good job to show us which areas of a city are susceptible to more criminal cases:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># Create a base map</span>
</span></span><span style=display:flex><span>m_5 <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>42.32</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>71.0589</span>], tiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cartodbpositron&#39;</span>, zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add a heatmap to the base map</span>
</span></span><span style=display:flex><span>HeatMap(data<span style=color:#f92672>=</span>crimes[[<span style=color:#e6db74>&#39;Lat&#39;</span>, <span style=color:#e6db74>&#39;Long&#39;</span>]], radius<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>)<span style=color:#f92672>.</span>add_to(m_5)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display the map</span>
</span></span><span style=display:flex><span>m_5
</span></span></code></pre></td></tr></table></div></div><p>Well, you should notice that heatmap makes geographic boundaries between different areas non-distinguishable. We can also use choropleth maps instead to visualize the crime rate by district.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># GeoDataFrame with geographical boundaries of Boston police districts</span>
</span></span><span style=display:flex><span>districts_full <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>read_file(<span style=color:#e6db74>&#39;../input/geospatial-learn-course-data/Police_Districts/Police_Districts/Police_Districts.shp&#39;</span>)
</span></span><span style=display:flex><span>districts <span style=color:#f92672>=</span> districts_full[[<span style=color:#e6db74>&#34;DISTRICT&#34;</span>, <span style=color:#e6db74>&#34;geometry&#34;</span>]]<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#34;DISTRICT&#34;</span>)
</span></span><span style=display:flex><span>districts<span style=color:#f92672>.</span>head()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Number of crimes in each police district</span>
</span></span><span style=display:flex><span>plot_dict <span style=color:#f92672>=</span> crimes<span style=color:#f92672>.</span>DISTRICT<span style=color:#f92672>.</span>value_counts()
</span></span><span style=display:flex><span>plot_dict<span style=color:#f92672>.</span>head()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create a base map</span>
</span></span><span style=display:flex><span>m_6 <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>42.32</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>71.0589</span>], tiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cartodbpositron&#39;</span>, zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add a choropleth map to the base map</span>
</span></span><span style=display:flex><span>Choropleth(geo_data<span style=color:#f92672>=</span>districts<span style=color:#f92672>.</span>__geo_interface__, 
</span></span><span style=display:flex><span>           data<span style=color:#f92672>=</span>plot_dict, 
</span></span><span style=display:flex><span>           key_on<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;feature.id&#34;</span>, 
</span></span><span style=display:flex><span>           fill_color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;YlGnBu&#39;</span>, 
</span></span><span style=display:flex><span>           legend_name<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Major criminal incidents (Jan-Aug 2018)&#39;</span>
</span></span><span style=display:flex><span>          )<span style=color:#f92672>.</span>add_to(m_6)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display the map</span>
</span></span><span style=display:flex><span>m_6
</span></span></code></pre></td></tr></table></div></div><h2 id=4-manipulating-geospatial-data>4. Manipulating Geospatial Data<a hidden class=anchor aria-hidden=true href=#4-manipulating-geospatial-data>#</a></h2><p>When we are using application such a Google Maps, we could easily get a place location on the map by just knowing the address or name. In fact, we are using what it&rsquo;s known as geocoder to generate locations of the places that we want to go.</p><p>Here&rsquo;s an interesting example where we try to geocode 100 top universities in Europe with only the universities name:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># 1. prepare a dataset with the universitites name</span>
</span></span><span style=display:flex><span>universities <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;../input/geospatial-learn-course-data/top_universities.csv&#34;</span>)
</span></span><span style=display:flex><span>universities<span style=color:#f92672>.</span>head()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. apply geocode to each of the universitites</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>my_geocoder</span>(row):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        point <span style=color:#f92672>=</span> geolocator<span style=color:#f92672>.</span>geocode(row)<span style=color:#f92672>.</span>point
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pd<span style=color:#f92672>.</span>Series({<span style=color:#e6db74>&#39;Latitude&#39;</span>: point<span style=color:#f92672>.</span>latitude, <span style=color:#e6db74>&#39;Longitude&#39;</span>: point<span style=color:#f92672>.</span>longitude})
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>universities[[<span style=color:#e6db74>&#39;Latitude&#39;</span>, <span style=color:#e6db74>&#39;Longitude&#39;</span>]] <span style=color:#f92672>=</span> universities<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: my_geocoder(x[<span style=color:#e6db74>&#39;Name&#39;</span>]), axis<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{}% o</span><span style=color:#e6db74>f addresses were geocoded!&#34;</span><span style=color:#f92672>.</span>format(
</span></span><span style=display:flex><span>    (<span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span> sum(np<span style=color:#f92672>.</span>isnan(universities[<span style=color:#e6db74>&#34;Latitude&#34;</span>])) <span style=color:#f92672>/</span> len(universities)) <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Drop universities that were not successfully geocoded</span>
</span></span><span style=display:flex><span>universities <span style=color:#f92672>=</span> universities<span style=color:#f92672>.</span>loc[<span style=color:#f92672>~</span>np<span style=color:#f92672>.</span>isnan(universities[<span style=color:#e6db74>&#34;Latitude&#34;</span>])]
</span></span><span style=display:flex><span>universities <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>GeoDataFrame(
</span></span><span style=display:flex><span>    universities, geometry<span style=color:#f92672>=</span>gpd<span style=color:#f92672>.</span>points_from_xy(universities<span style=color:#f92672>.</span>Longitude, universities<span style=color:#f92672>.</span>Latitude))
</span></span><span style=display:flex><span>universities<span style=color:#f92672>.</span>crs <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;init&#39;</span>: <span style=color:#e6db74>&#39;epsg:4326&#39;</span>}
</span></span><span style=display:flex><span>universities<span style=color:#f92672>.</span>head()
</span></span></code></pre></td></tr></table></div></div><p>Now let&rsquo;s plot out the locations to see if they are accurate:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># Create a map</span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>54</span>, <span style=color:#ae81ff>15</span>], tiles<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;openstreetmap&#39;</span>, zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Add points to the map</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> idx, row <span style=color:#f92672>in</span> universities<span style=color:#f92672>.</span>iterrows():
</span></span><span style=display:flex><span>    Marker([row[<span style=color:#e6db74>&#39;Latitude&#39;</span>], row[<span style=color:#e6db74>&#39;Longitude&#39;</span>]], popup<span style=color:#f92672>=</span>row[<span style=color:#e6db74>&#39;Name&#39;</span>])<span style=color:#f92672>.</span>add_to(m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Display the map</span>
</span></span><span style=display:flex><span>m
</span></span></code></pre></td></tr></table></div></div><h3 id=41-table-joins>4.1 Table Joins<a hidden class=anchor aria-hidden=true href=#41-table-joins>#</a></h3><p>In this section, we will explore on combining data frames with shared index for the case of <code>GeoDataFrame</code>. An example is that we have a dataset with boundaries of every country in Europe and a dataset with their estimated population and GDP, we can perform attribute join to merge the two datasets:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>europe <span style=color:#f92672>=</span> europe_boundaries<span style=color:#f92672>.</span>merge(europe_stats, on<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;name&#34;</span>)
</span></span><span style=display:flex><span>europe<span style=color:#f92672>.</span>head()
</span></span></code></pre></td></tr></table></div></div><p>Furthermore, it is also possible to merge <code>GeoDataFrame</code> based on spatial relationship between objects in geometry columns. Recall back that we geocode top 100 universities in Europe previously. Can we match each university with its corresponding country? Spatial join allow us to perform match for such as scenario.</p><blockquote><p><em>The spatial join above looks at the &ldquo;geometry&rdquo; columns in both <code>GeoDataFrames</code>. If a Point object from the universities <code>GeoDataFrame</code> intersects a Polygon object from the <code>europe</code> DataFrame, the corresponding rows are combined and added as a single row of the <code>european_universities</code> DataFrame. Otherwise, countries without a matching university (and universities without a matching country) are omitted from the results.</em></p></blockquote><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># Use spatial join to match universities to countries in Europe</span>
</span></span><span style=display:flex><span>european_universities <span style=color:#f92672>=</span> gpd<span style=color:#f92672>.</span>sjoin(universities, europe)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Investigate the result</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;We located </span><span style=color:#e6db74>{}</span><span style=color:#e6db74> universities.&#34;</span><span style=color:#f92672>.</span>format(len(universities)))
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Only </span><span style=color:#e6db74>{}</span><span style=color:#e6db74> of the universities were located in Europe (in </span><span style=color:#e6db74>{}</span><span style=color:#e6db74> different countries).&#34;</span><span style=color:#f92672>.</span>format(
</span></span><span style=display:flex><span>    len(european_universities), len(european_universities<span style=color:#f92672>.</span>name<span style=color:#f92672>.</span>unique())))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>european_universities<span style=color:#f92672>.</span>head()
</span></span></code></pre></td></tr></table></div></div><h2 id=5-proximity-analysis>5. Proximity Analysis<a hidden class=anchor aria-hidden=true href=#5-proximity-analysis>#</a></h2><p>For the previous four sections, we are exposed to a lot of the functions in <code>geopandas</code>. Here, we will look into some application areas with the learned functions:</p><p>Some useful application:</p><ul><li>Measuring distance between points on a map</li><li>Select points within some radius of a feature</li></ul><p>To compute distances from two <code>GeoDataFrames</code>, we need to make sure they have the same CRS. The distances can be easily computed in <code>GeoPandas</code>. Moreover, we can find the mean distance between two points with <code>mean</code> too. Here&rsquo;s an example where we deal with dataset with air quality monitoring stations in the same city where we would like to know the mean distance from one monitoring station to the other:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># check CRS of geodataframes</span>
</span></span><span style=display:flex><span>print(stations<span style=color:#f92672>.</span>crs)
</span></span><span style=display:flex><span>print(releases<span style=color:#f92672>.</span>crs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Select one release incident in particular</span>
</span></span><span style=display:flex><span>recent_release <span style=color:#f92672>=</span> releases<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>360</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Measure distance from release to each station</span>
</span></span><span style=display:flex><span>distances <span style=color:#f92672>=</span> stations<span style=color:#f92672>.</span>geometry<span style=color:#f92672>.</span>distance(recent_release<span style=color:#f92672>.</span>geometry)
</span></span><span style=display:flex><span>distances
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># find the mean distance</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;Mean distance to monitoring stations: </span><span style=color:#e6db74>{}</span><span style=color:#e6db74> feet&#39;</span><span style=color:#f92672>.</span>format(distances<span style=color:#f92672>.</span>mean()))
</span></span></code></pre></td></tr></table></div></div><h3 id=51-creating-a-buffer>5.1 Creating a Buffer<a hidden class=anchor aria-hidden=true href=#51-creating-a-buffer>#</a></h3><p>The purpose of creating a buffer is for us to understand points on a map that lies some radius away from a point. For example, there&rsquo;s a toxic gas being release accidentally to the air. There are some air quality monitoring centers nearby. We want to know whether those centers are able to detect the toxic gas.</p><p>A working example would be as follows:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># 1. creating a two miles buffer</span>
</span></span><span style=display:flex><span>two_mile_buffer <span style=color:#f92672>=</span> stations<span style=color:#f92672>.</span>geometry<span style=color:#f92672>.</span>buffer(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#ae81ff>5280</span>)
</span></span><span style=display:flex><span>two_mile_buffer<span style=color:#f92672>.</span>head()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. create map with release incidents and monitoring stations</span>
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> folium<span style=color:#f92672>.</span>Map(location<span style=color:#f92672>=</span>[<span style=color:#ae81ff>39.9526</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>75.1652</span>], zoom_start<span style=color:#f92672>=</span><span style=color:#ae81ff>11</span>)
</span></span><span style=display:flex><span>HeatMap(data<span style=color:#f92672>=</span>releases[[<span style=color:#e6db74>&#39;LATITUDE&#39;</span>, <span style=color:#e6db74>&#39;LONGITUDE&#39;</span>]], radius<span style=color:#f92672>=</span><span style=color:#ae81ff>15</span>)<span style=color:#f92672>.</span>add_to(m)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> idx, row <span style=color:#f92672>in</span> stations<span style=color:#f92672>.</span>iterrows():
</span></span><span style=display:flex><span>    Marker([row[<span style=color:#e6db74>&#39;LATITUDE&#39;</span>], row[<span style=color:#e6db74>&#39;LONGITUDE&#39;</span>]])<span style=color:#f92672>.</span>add_to(m)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#75715e># Plot each polygon on the map</span>
</span></span><span style=display:flex><span>GeoJson(two_mile_buffer<span style=color:#f92672>.</span>to_crs(epsg<span style=color:#f92672>=</span><span style=color:#ae81ff>4326</span>))<span style=color:#f92672>.</span>add_to(m)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Show the map</span>
</span></span><span style=display:flex><span>m
</span></span></code></pre></td></tr></table></div></div><p>Now we want to check if a toxic release occurred within 2 miles of any monitoring station, to do that we would need to test each polygon. But that would be tedious work. Consider combining all the polygons into one object, we can check whether the toxic gas is within the radar of the closest monitoring station:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># check if output is true</span>
</span></span><span style=display:flex><span>my_union<span style=color:#f92672>.</span>contains(releases<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>360</span>]<span style=color:#f92672>.</span>geometry)
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/python/>Python</a></li><li><a href=http://localhost:1313/tags/data-analysis/>Data Analysis</a></li><li><a href=http://localhost:1313/tags/geospatial-analysis/>Geospatial Analysis</a></li><li><a href=http://localhost:1313/tags/kaggle/>Kaggle</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/2023/2023-08-13-webscraping-on-xpath/><span class=title>« Bài mới hơn</span><br><span>Webscraping On Xpath</span>
</a><a class=next href=http://localhost:1313/posts/2023/2023-04-09-creating-a-website-with-hugo--papermode/><span class=title>Bài cũ hơn »</span><br><span>Creating a Website With Hugo & PaperMode</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Geospatial Analysis on x" href="https://x.com/intent/tweet/?text=Geospatial%20Analysis&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f&amp;hashtags=Python%2cDataAnalysis%2cGeospatialAnalysis%2cKaggle"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Geospatial Analysis on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f&amp;title=Geospatial%20Analysis&amp;summary=Geospatial%20Analysis&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Geospatial Analysis on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f&title=Geospatial%20Analysis"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Geospatial Analysis on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Geospatial Analysis on whatsapp" href="https://api.whatsapp.com/send?text=Geospatial%20Analysis%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Geospatial Analysis on telegram" href="https://telegram.me/share/url?text=Geospatial%20Analysis&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Geospatial Analysis on ycombinator" href="https://news.ycombinator.com/submitlink?t=Geospatial%20Analysis&u=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-04-19-geospatial-analysis%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>The Financial Engineer</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Sao chép";function s(){t.innerHTML="Đã sao chép!",setTimeout(()=>{t.innerHTML="Sao chép"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>