<!doctype html><html lang=vi dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Pandas | The Financial Engineer</title>
<meta name=keywords content="Pandas,Data Frame,Python"><meta name=description content="My Kaggle Learning Note "><meta name=author content="Kean Teng Blog"><link rel=canonical href=http://localhost:1313/posts/2023/2023-08-18-pandas/><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=vi href=http://localhost:1313/posts/2023/2023-08-18-pandas/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Pandas"><meta property="og:description" content="My Kaggle Learning Note "><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/2023/2023-08-18-pandas/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-08-18T00:00:00+00:00"><meta property="og:site_name" content="QHung's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pandas"><meta name=twitter:description content="My Kaggle Learning Note "><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Pandas","item":"http://localhost:1313/posts/2023/2023-08-18-pandas/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Pandas","name":"Pandas","description":"My Kaggle Learning Note ","keywords":["Pandas","Data Frame","Python"],"articleBody":" Disclaimer: This article is my learning note from the courses I took from Kaggle.\nIn this course, we will explore on the Python pandas module which is a popular library for data analysis. With pandas, we can use it to create data and also work or manipulate the existing data.\n1. Introduction pandas has two core objects known as DataFrame and Series. A DataFrame is a table where it consists of individual entries in the form of an array. Each entry corresponds to a row and a column. For example:\nLet us define a DataFrame, we can also write string in the DataFrame:\n1 2 3 4 5 import pandas as pd pd.DataFrame({ 'x': [1,2,3], 'y': [3,2,1], }) | x | y | |---|---| | 1 | 3 | | 2 | 2 | | 3 | 1 | In the above code we are defining x and y as the column names, and we assigned values to the column. Now, let’s try to put an index or row labels to the DataFrame:\n1 2 3 4 5 pd.DataFrame({ 'x': [1,2,3], 'y': [3,2,1]}, index = ['Row 1', 'Row 2', 'Row 3'] ) | | x | y | |-----|---|---| |Row 1| 1 | 3 | |Row 2| 2 | 2 | |Row 3| 3 | 1 | On the other hand, for Series, it represents a sequence of data values. Just now we have shown that DataFrame is in the form of table, but Series is in the form of a list. Let’s try defining one:\n1 pd.Series([1,2,3,4]) We can think of a series as only a single column of a DataFrane. In fact, we can add row label or index to Series too:\n1 pd.Series([1,2,3,4], index = ['Row 1', 'Row 2', 'Row 3', 'Row 4'], name = \"My Series\") |Row 1| 1 | |Row 2| 2 | |Row 3| 3 | Name: Product A 1.1 Reading Data Files We can use pandas to read .csv file as well, by typing df = pd.read_csv('file.csv').\nTo check how large the DataFrame is:\n1 df.shape() Here’s how we can take a preview of the first five rows of the DataFrame:\n1 2 df.head() # try df.head(10) for first 10 rows You might be wondering, can we display only the last five rows? Of course:\n1 df.tail() 2. Indexing, Selecting \u0026 Assigning We have learned how to create a Series and a DataFrame. Now let’s look at how do we select specific value in the DataFrame in a quick and effective manner.\nLet’s say we have a DataFrame called df with the following column names: country, points, price, province, state and so on. If we would like to only see the country column, we could access the column by doing this:\n1 2 3 4 df.country # or alternatively df['country'] Notice two approaches are provided above. Neither of them is more or less syntactically valid than the other. But let’s say we have a column name My House, we just could not write df.My House, it wouldn’t work.\nIf we want to know the first item in the country column, we can use the indexing operator to drill down to a single specific value:\n1 df['country'][0] 2.1 Indexing in Pandas In pandas, indexing works in one of two paradigms. We will start with the first one, the index-based selection where data is selected based on its numerical position in the data. To select the first row of a data:\n1 df.iloc[0] For the loc and iloc function, row will come first then column.\n1 df.iloc[:,0] # display all row of first column The : operator means everything. We can use it to indicate the range of values that we are interested in:\n1 df.iloc[:3, 0] # first three rows of the first column (index 3 or fourth row excluded) 1 2 3 4 df.iloc[1:3, 0] # second and third rows of the first column # alternatively df.iloc[[1,2], 0] Interestingly, we can also use negative number to select data items. For negative number, it will start counting from the end of the values:\n1 df.iloc[-5:] # get the last five rows for all columns Furthermore, a second paradigm for attribute selection is done by using the loc operator, called as label-based selection. For this approach, it is the data index value, rather than the position that matters.\n1 df.loc[0, 'country'] # first item in the country column When we compare iloc and loc, iloc seems to be conceptually simpler than loc. This is because we ignore the dataset’s indices. Using iloc, dataset is treated like a big matrix, that we index into by position. For loc, we make use of the information in the indices to do its work. Of course, dataset usually comes with indices and this makes loc to be easier to work with.\n1 df.loc[:, ['country', 'regions', 'states']] # display all rows for the column of country, regions and states So, how do we choose between iloc and loc? For iloc, it uses the Python standard library indexing scheme, where the first element in the range is included, and the last one is excluded. But for loc, it will include both the first and last element. Of course, using iloc can be confusing sometimes. Here’s a comparison:\nUsing loc: 0:10 Output: 0,1,...,10 Using iloc 0:10 Output: 0,1,...,9 2.2 Manipulation Index When using label-based selection, the power of it comes from the labels in the index. We can manipulate index in any way we see fit as well by using set_index()\n1 df.set_index(\"country\") 2.3 Conditional Selection In order to do some interesting things with our dataset, we often need to ask questions based on certain conditions. Suppose that we want to know the better-than-average wine produced in Sweden, we can start by checking whether the wine is from Sweden or not:\n1 2 3 4 wine.country == 'Sweden' # alternatively wine.loc[wine.country == 'Sweden'] Now we would like to add an extra condition. We want the wine review to also be at least 90 points:\n1 wine.loc[(wine.country == 'Sweden') \u0026 (wine.points \u003e= 90)] If we would like to know whether a wine is from Sweden or a wine is rated above average:\n1 wine.loc[(wine.country == 'Sweden') | (wine.points \u003e= 90)] What if we want to know whether a wine is produced in Sweden or Italy?\n1 wine.loc[wine.country.isin(['Sweden', 'Italy'])] We notice that for the wine data produced in Sweden or Italy, there are some rows where the points given is empty, we would like to filter them out:\n1 2 3 4 wine.loc[wine.points.notnull()] # to check for the null rows wine.loc[wine.points.isnull()] 2.4 Assigning Data Now let’s look at the method to assign data to a DataFrame:\n1 wine['critic'] = everyone # assingning a constant to the column named critic 1 wine['index_reverse'] = range(len('country'),0,-1) 3. Summary Functions \u0026 Maps In the previous section, we learned about selecting relevant data from a DataFrame and a Series. However, data does not always come out in the format that we want, and often we would want to do some more works to reformat the data at hand. For starter, we could use the describe function to generate a high-level summary of the attributes of the given column:\n1 wine.describe() We can select the column that we want to know the summary:\n1 winde.critic.describe() Notice that for numerical column, the describe function is telling use about the name, the maximum and the minimum value and a few other information. If we only want to know, says, the mean or the unique labels in a column, we could:\n1 2 wine.points.mean() wine.critic.unique() Let’s say we want to know for a list of unique value, how frequent they occur in the dataset:\n1 wine.critic.value_counts() 3.1 Maps Map is a mathematical term where it describes that a function takes one set of values and maps them to another set of value. Oftentimes, we have to create new representations from existing data or perform transformation to the data. Maps are extremely important to help us to achieve our works.\nAn example where we remean the scores the wines received to 0:\n1 2 3 4 5 6 wine_points_mean = wine.points.mean() wine_points_mean.map(lambda p : p - wine_points_mean) # alternative wine_points_mean = wine.points.mean() wine.points - wine_points_mean In the function above, map() expects a single value from the Series and return a transformed version of that value. A new series with all the transformed values will be returned by map().\nOn the other hand, we can use apply() which is also an equivalent method. Now we want to transform the whole DataFrame by calling a function on each row:\n1 2 3 4 5 def remean(row): row.points = row.points - wine_points_mean return row wine.apply(remean, axis = 'columns') If we set the axis = index, then we would need to give a function to transform each column rather than each row.\nmap and apply do not modify the original data they’re call on. They return new, transformed series and DataFrame respectively.\nPandas understand what we do when we perform operations between Series of equal length. These operations are faster than using map or apply. Of course, we can use these functions with more advanced case like conditional logic.\n1 wine.country + \" - \" + wine_region 4. Grouping \u0026 Sorting 4.1 Groupwise Analysis In previous section, we learned about value_counts() to count for the unique labels’ occurrences. Here’s an alternative:\n1 wine.groupby('points').points.count() This groupby function creates a group of reviews which allotted the same point values to the given wine. Then from these groups, we select the points column and count how many times they appear. For example, we want to get the cheapest wine in each point value category:\n1 wine.groupby('points').price.min() We can think of each group as a slice of our DataFrame with only data with values that match. This DataFrane is accessible to use directly using apply, and we can manipulate the data. If we want to select the name of the first wine reviewed from each winery:\n1 wine.groupby('winery').apply(lambda df : df.title.iloc[0]) We can also group more than one column. Let’s say we want to pick out the best wine by country and province:\n1 wine.groupby(['country', 'province']).apply(lambda x : x.loc[x.points.idmax()]) Furthermore, if we want to run a bunch of different functions on the DataFrame at once, we can generate a simple statistical summary of the dataset with agg:\n1 wine.groupby(['country']).price.agg([len, min, max]) 4.2 Multi-indexes A multi-index example:\n1 2 countries_reviewed = wine.groupby(['country', 'province']).description.agg([len]) countries_reviewed | country | province | len | |---------|------------------|-----| |Argentina| Mendoza Province | 3264| | | Other | 536 | |... | ... | | If we check the type:\n1 2 3 4 5 mi = countries_reviewed.index type(mi) # output # pandas.core.indexes.multi.MultiIndex There are a few ways to deal with this tiered structure which are absent for single-level indices. To retrieve a value, we need to provide two levels of labels. For the first method, we can convert the index back to the regular index:\n1 countries_reviewed.reset_index() | | country | province | len | |-|---------|------------------|-----| |0|Argentina| Mendoza Province | 3264| |1|Argentina| Other | 536 | |2|... | ... | ... | 4.3. Sorting Previously, we learned about the grouping function to group data in index order. But what about in value order? Can we order the rows from the grouping result based on values in the data rather than index?\n1 2 countries_reviewed = countries_reviewed.reset_index() countries_reviewed.sort_values(by = 'len') By default, the sorting will be in ascending order, we can change that by changing the ascending parameter:\n1 countries_reviewed.sort_values(by = 'len', ascending = False) Moreover, if we just want to sort by index values, simply leave the by parameter blank:\n1 countries_reviewed.sort_values() Of course, we could sort more than one column at a time:\n1 countries_reviewed.sort_values(by = ['country', 'len']) 5. Data Types \u0026 Missing Values In this section, we will explore how to investigate data types within a DataFrame and how to replace entries in it.\n1 2 3 wine.price.dtype() # for the specified column wine.dtype() # for all columns dtype function tells us how pandas store the data internally such as float64 or int64. We can convert a column from one type to the other too:\n1 wine.points.astype('float64') 5.1 Missing Value In a dataset, we might see values being given as NaN or “not a number”. Using Pandas, we can check for the missing data in a DataFrame:\n1 wine[pd.isnull(wine.country)] To replace the missing value in data, we can use the fillna() function:\n1 wine.region.fllna(\"Unknown\") If we want to replace value, here’s what we can do:\n1 wine.twitter_handle.replace(\"@x\", \"@abc\") 6. Renaming \u0026 Combining rename is a function to let you change index names or column names:\n1 wine.rename(column = {'point': 'score'}) This function allows us to rename index or column by specifying an index or a column keyword parameter:\n1 wine.rename(index = {0: 'first', 1: 'second'}) Of course, we could give name to a row index and the column index as well:\n1 wine.rename_axis('wines', axis = 'rows').rename_axis('fields', axis = 'columns') 6.1 Combining The simplest combination method in Pandas is concat. This function is useful when we have data in different DataFrame but having the same columns:\n1 pd.concat([can_yt, bri_yt]) Moreover, for join, it will combine different DataFrame which have an index in common:\n1 2 3 4 left = canadian_youtube.set_index(['title', 'trending_date']) right = british_youtube.set_index(['title', 'trending_date']) left.join(right, lsuffix='_CAN', rsuffix='_UK') For the above example, the lsuffix and rsuffix parameter is necessary because the data has the same columns names in both of the datasets. If it is not, then we could just ignore that.\n","wordCount":"2254","inLanguage":"vi","datePublished":"2023-08-18T00:00:00Z","dateModified":"2023-08-18T00:00:00Z","author":{"@type":"Person","name":"Kean Teng Blog"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/2023/2023-08-18-pandas/"},"publisher":{"@type":"Organization","name":"The Financial Engineer","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="The Financial Engineer (Alt + H)">The Financial Engineer</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/about/ title=About><span>About</span></a></li><li><a href=http://localhost:1313/archives/ title=Archive><span>Archive</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Pandas</h1><div class=post-description>My Kaggle Learning Note</div><div class=post-meta><span title='2023-08-18 00:00:00 +0000 UTC'>tháng 8 18, 2023</span>&nbsp;·&nbsp;11 phút&nbsp;·&nbsp;Kean Teng Blog</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Mục lục</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-introduction>1. Introduction</a><ul><li><a href=#11-reading-data-files>1.1 Reading Data Files</a></li></ul></li><li><a href=#2-indexing-selecting--assigning>2. Indexing, Selecting & Assigning</a><ul><li><a href=#21-indexing-in-pandas>2.1 Indexing in Pandas</a></li><li><a href=#22-manipulation-index>2.2 Manipulation Index</a></li><li><a href=#23-conditional-selection>2.3 Conditional Selection</a></li><li><a href=#24-assigning-data>2.4 Assigning Data</a></li></ul></li><li><a href=#3-summary-functions--maps>3. Summary Functions & Maps</a><ul><li><a href=#31-maps>3.1 Maps</a></li></ul></li><li><a href=#4-grouping--sorting>4. Grouping & Sorting</a><ul><li><a href=#41-groupwise-analysis>4.1 Groupwise Analysis</a></li><li><a href=#42-multi-indexes>4.2 Multi-indexes</a></li><li><a href=#43-sorting>4.3. Sorting</a></li></ul></li><li><a href=#5-data-types--missing-values>5. Data Types & Missing Values</a><ul><li><a href=#51-missing-value>5.1 Missing Value</a></li></ul></li><li><a href=#6-renaming--combining>6. Renaming & Combining</a><ul><li><a href=#61-combining>6.1 Combining</a></li></ul></li></ul></nav></div></details></div><div class=post-content><blockquote><p><em>Disclaimer: This article is my learning note from the courses I took from Kaggle.</em></p></blockquote><p>In this course, we will explore on the Python <code>pandas</code> module which is a popular library for data analysis. With <code>pandas</code>, we can use it to create data and also work or manipulate the existing data.</p><h2 id=1-introduction>1. Introduction<a hidden class=anchor aria-hidden=true href=#1-introduction>#</a></h2><p><code>pandas</code> has two core objects known as <code>DataFrame</code> and Series. A <code>DataFrame</code> is a table where it consists of individual entries in the form of an array. Each entry corresponds to a row and a column. For example:</p><p>Let us define a <code>DataFrame</code>, we can also write string in the <code>DataFrame</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span>pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;x&#39;</span>: [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;y&#39;</span>: [<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span>})
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>| x | y |
|---|---|
| 1 | 3 |
| 2 | 2 |
| 3 | 1 |
</code></pre><p>In the above code we are defining x and y as the column names, and we assigned values to the column. Now, let&rsquo;s try to put an index or row labels to the <code>DataFrame</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>pd<span style=color:#f92672>.</span>DataFrame({
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;x&#39;</span>: [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>],
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;y&#39;</span>: [<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>]},
</span></span><span style=display:flex><span>    index <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Row 1&#39;</span>, <span style=color:#e6db74>&#39;Row 2&#39;</span>, <span style=color:#e6db74>&#39;Row 3&#39;</span>]    
</span></span><span style=display:flex><span>)
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>|     | x | y |
|-----|---|---|
|Row 1| 1 | 3 |
|Row 2| 2 | 2 |
|Row 3| 3 | 1 |
</code></pre><p>On the other hand, for Series, it represents a sequence of data values. Just now we have shown that <code>DataFrame</code> is in the form of table, but Series is in the form of a list. Let&rsquo;s try defining one:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>pd<span style=color:#f92672>.</span>Series([<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>])
</span></span></code></pre></td></tr></table></div></div><p>We can think of a series as only a single column of a <code>DataFrane</code>. In fact, we can add row label or index to Series too:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>pd<span style=color:#f92672>.</span>Series([<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>], index <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Row 1&#39;</span>, <span style=color:#e6db74>&#39;Row 2&#39;</span>, <span style=color:#e6db74>&#39;Row 3&#39;</span>, <span style=color:#e6db74>&#39;Row 4&#39;</span>], name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;My Series&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>|Row 1| 1 |
|Row 2| 2 |
|Row 3| 3 |
Name: Product A
</code></pre><h3 id=11-reading-data-files>1.1 Reading Data Files<a hidden class=anchor aria-hidden=true href=#11-reading-data-files>#</a></h3><p>We can use <code>pandas</code> to read <code>.csv</code> file as well, by typing <code>df = pd.read_csv('file.csv')</code>.</p><p>To check how large the <code>DataFrame</code> is:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>shape()
</span></span></code></pre></td></tr></table></div></div><p>Here&rsquo;s how we can take a preview of the first five rows of the <code>DataFrame</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>head()
</span></span><span style=display:flex><span><span style=color:#75715e># try df.head(10) for first 10 rows</span>
</span></span></code></pre></td></tr></table></div></div><p>You might be wondering, can we display only the last five rows? Of course:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>tail()
</span></span></code></pre></td></tr></table></div></div><h2 id=2-indexing-selecting--assigning>2. Indexing, Selecting & Assigning<a hidden class=anchor aria-hidden=true href=#2-indexing-selecting--assigning>#</a></h2><p>We have learned how to create a Series and a <code>DataFrame</code>. Now let&rsquo;s look at how do we select specific value in the <code>DataFrame</code> in a quick and effective manner.</p><p>Let&rsquo;s say we have a <code>DataFrame</code> called <code>df</code> with the following column names: country, points, price, province, state and so on. If we would like to only see the country column, we could access the column by doing this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>country
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># or alternatively</span>
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;country&#39;</span>]
</span></span></code></pre></td></tr></table></div></div><p>Notice two approaches are provided above. Neither of them is more or less syntactically valid than the other. But let&rsquo;s say we have a column name <code>My House</code>, we just could not write <code>df.My House</code>, it wouldn&rsquo;t work.</p><p>If we want to know the first item in the country column, we can use the indexing operator to drill down to a single specific value:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df[<span style=color:#e6db74>&#39;country&#39;</span>][<span style=color:#ae81ff>0</span>]
</span></span></code></pre></td></tr></table></div></div><h3 id=21-indexing-in-pandas>2.1 Indexing in Pandas<a hidden class=anchor aria-hidden=true href=#21-indexing-in-pandas>#</a></h3><p>In <code>pandas</code>, indexing works in one of two paradigms. We will start with the first one, the index-based selection where data is selected based on its numerical position in the data. To select the first row of a data:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>0</span>]
</span></span></code></pre></td></tr></table></div></div><p>For the <code>loc</code> and <code>iloc</code> function, row will come first then column.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>iloc[:,<span style=color:#ae81ff>0</span>] <span style=color:#75715e># display all row of first column</span>
</span></span></code></pre></td></tr></table></div></div><p>The <code>:</code> operator means everything. We can use it to indicate the range of values that we are interested in:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>iloc[:<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>] <span style=color:#75715e># first three rows of the first column (index 3 or fourth row excluded)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>1</span>:<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>0</span>] <span style=color:#75715e># second and third rows of the first column</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># alternatively</span>
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>iloc[[<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>], <span style=color:#ae81ff>0</span>]
</span></span></code></pre></td></tr></table></div></div><p>Interestingly, we can also use negative number to select data items. For negative number, it will start counting from the end of the values:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>iloc[<span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>:] <span style=color:#75715e># get the last five rows for all columns</span>
</span></span></code></pre></td></tr></table></div></div><p>Furthermore, a second paradigm for attribute selection is done by using the <code>loc</code> operator, called as label-based selection. For this approach, it is the data index value, rather than the position that matters.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>loc[<span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;country&#39;</span>] <span style=color:#75715e># first item in the country column</span>
</span></span></code></pre></td></tr></table></div></div><p>When we compare <code>iloc</code> and <code>loc</code>, <code>iloc</code> seems to be conceptually simpler than <code>loc</code>. This is because we ignore the dataset&rsquo;s indices. Using <code>iloc</code>, dataset is treated like a big matrix, that we index into by position. For <code>loc</code>, we make use of the information in the indices to do its work. Of course, dataset usually comes with indices and this makes <code>loc</code> to be easier to work with.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>loc[:, [<span style=color:#e6db74>&#39;country&#39;</span>, <span style=color:#e6db74>&#39;regions&#39;</span>, <span style=color:#e6db74>&#39;states&#39;</span>]] <span style=color:#75715e># display all rows for the column of country, regions and states</span>
</span></span></code></pre></td></tr></table></div></div><p>So, how do we choose between <code>iloc</code> and <code>loc</code>? For <code>iloc</code>, it uses the Python standard library indexing scheme, where the first element in the range is included, and the last one is excluded. But for <code>loc</code>, it will include both the first and last element. Of course, using <code>iloc</code> can be confusing sometimes. Here&rsquo;s a comparison:</p><pre tabindex=0><code>Using loc: 0:10
Output: 0,1,...,10

Using iloc 0:10
Output: 0,1,...,9
</code></pre><h3 id=22-manipulation-index>2.2 Manipulation Index<a hidden class=anchor aria-hidden=true href=#22-manipulation-index>#</a></h3><p>When using label-based selection, the power of it comes from the labels in the index. We can manipulate index in any way we see fit as well by using <code>set_index()</code></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>df<span style=color:#f92672>.</span>set_index(<span style=color:#e6db74>&#34;country&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><h3 id=23-conditional-selection>2.3 Conditional Selection<a hidden class=anchor aria-hidden=true href=#23-conditional-selection>#</a></h3><p>In order to do some interesting things with our dataset, we often need to ask questions based on certain conditions. Suppose that we want to know the better-than-average wine produced in Sweden, we can start by checking whether the wine is from Sweden or not:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>country <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Sweden&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># alternatively</span>
</span></span><span style=display:flex><span>wine<span style=color:#f92672>.</span>loc[wine<span style=color:#f92672>.</span>country <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Sweden&#39;</span>]
</span></span></code></pre></td></tr></table></div></div><p>Now we would like to add an extra condition. We want the wine review to also be at least 90 points:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>loc[(wine<span style=color:#f92672>.</span>country <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Sweden&#39;</span>) <span style=color:#f92672>&amp;</span> (wine<span style=color:#f92672>.</span>points <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>90</span>)]
</span></span></code></pre></td></tr></table></div></div><p>If we would like to know whether a wine is from Sweden or a wine is rated above average:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>loc[(wine<span style=color:#f92672>.</span>country <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;Sweden&#39;</span>) <span style=color:#f92672>|</span> (wine<span style=color:#f92672>.</span>points <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>90</span>)]
</span></span></code></pre></td></tr></table></div></div><p>What if we want to know whether a wine is produced in Sweden or Italy?</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>loc[wine<span style=color:#f92672>.</span>country<span style=color:#f92672>.</span>isin([<span style=color:#e6db74>&#39;Sweden&#39;</span>, <span style=color:#e6db74>&#39;Italy&#39;</span>])]
</span></span></code></pre></td></tr></table></div></div><p>We notice that for the wine data produced in Sweden or Italy, there are some rows where the points given is empty, we would like to filter them out:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>loc[wine<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>notnull()]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># to check for the null rows</span>
</span></span><span style=display:flex><span>wine<span style=color:#f92672>.</span>loc[wine<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>isnull()]
</span></span></code></pre></td></tr></table></div></div><h3 id=24-assigning-data>2.4 Assigning Data<a hidden class=anchor aria-hidden=true href=#24-assigning-data>#</a></h3><p>Now let&rsquo;s look at the method to assign data to a <code>DataFrame</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine[<span style=color:#e6db74>&#39;critic&#39;</span>] <span style=color:#f92672>=</span> everyone <span style=color:#75715e># assingning a constant to the column named critic</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine[<span style=color:#e6db74>&#39;index_reverse&#39;</span>] <span style=color:#f92672>=</span> range(len(<span style=color:#e6db74>&#39;country&#39;</span>),<span style=color:#ae81ff>0</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) 
</span></span></code></pre></td></tr></table></div></div><h2 id=3-summary-functions--maps>3. Summary Functions & Maps<a hidden class=anchor aria-hidden=true href=#3-summary-functions--maps>#</a></h2><p>In the previous section, we learned about selecting relevant data from a <code>DataFrame</code> and a Series. However, data does not always come out in the format that we want, and often we would want to do some more works to reformat the data at hand. For starter, we could use the <code>describe</code> function to generate a high-level summary of the attributes of the given column:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>describe()
</span></span></code></pre></td></tr></table></div></div><p>We can select the column that we want to know the summary:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>winde<span style=color:#f92672>.</span>critic<span style=color:#f92672>.</span>describe()
</span></span></code></pre></td></tr></table></div></div><p>Notice that for numerical column, the <code>describe</code> function is telling use about the name, the maximum and the minimum value and a few other information. If we only want to know, says, the mean or the unique labels in a column, we could:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>wine<span style=color:#f92672>.</span>critic<span style=color:#f92672>.</span>unique()
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s say we want to know for a list of unique value, how frequent they occur in the dataset:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>critic<span style=color:#f92672>.</span>value_counts()
</span></span></code></pre></td></tr></table></div></div><h3 id=31-maps>3.1 Maps<a hidden class=anchor aria-hidden=true href=#31-maps>#</a></h3><p>Map is a mathematical term where it describes that a function takes one set of values and maps them to another set of value. Oftentimes, we have to create new representations from existing data or perform transformation to the data. Maps are extremely important to help us to achieve our works.</p><p>An example where we remean the scores the wines received to 0:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine_points_mean <span style=color:#f92672>=</span> wine<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>wine_points_mean<span style=color:#f92672>.</span>map(<span style=color:#66d9ef>lambda</span> p : p <span style=color:#f92672>-</span> wine_points_mean)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># alternative</span>
</span></span><span style=display:flex><span>wine_points_mean <span style=color:#f92672>=</span> wine<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>wine<span style=color:#f92672>.</span>points <span style=color:#f92672>-</span> wine_points_mean
</span></span></code></pre></td></tr></table></div></div><p>In the function above, <code>map()</code> expects a single value from the Series and return a transformed version of that value. A new series with all the transformed values will be returned by <code>map()</code>.</p><p>On the other hand, we can use <code>apply()</code> which is also an equivalent method. Now we want to transform the whole <code>DataFrame</code> by calling a function on each row:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>remean</span>(row):
</span></span><span style=display:flex><span>    row<span style=color:#f92672>.</span>points <span style=color:#f92672>=</span> row<span style=color:#f92672>.</span>points <span style=color:#f92672>-</span> wine_points_mean
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> row
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wine<span style=color:#f92672>.</span>apply(remean, axis <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;columns&#39;</span>)
</span></span></code></pre></td></tr></table></div></div><p>If we set the <code>axis = index</code>, then we would need to give a function to transform each column rather than each row.</p><p><code>map</code> and <code>apply</code> do not modify the original data they&rsquo;re call on. They return new, transformed series and <code>DataFrame</code> respectively.</p><p>Pandas understand what we do when we perform operations between Series of equal length. These operations are faster than using <code>map</code> or <code>apply</code>. Of course, we can use these functions with more advanced case like conditional logic.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>country <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; - &#34;</span> <span style=color:#f92672>+</span> wine_region
</span></span></code></pre></td></tr></table></div></div><h2 id=4-grouping--sorting>4. Grouping & Sorting<a hidden class=anchor aria-hidden=true href=#4-grouping--sorting>#</a></h2><h3 id=41-groupwise-analysis>4.1 Groupwise Analysis<a hidden class=anchor aria-hidden=true href=#41-groupwise-analysis>#</a></h3><p>In previous section, we learned about <code>value_counts()</code> to count for the unique labels&rsquo; occurrences. Here&rsquo;s an alternative:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;points&#39;</span>)<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>count()
</span></span></code></pre></td></tr></table></div></div><p>This <code>groupby</code> function creates a group of reviews which allotted the same point values to the given wine. Then from these groups, we select the <code>points</code> column and count how many times they appear. For example, we want to get the cheapest wine in each point value category:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;points&#39;</span>)<span style=color:#f92672>.</span>price<span style=color:#f92672>.</span>min()
</span></span></code></pre></td></tr></table></div></div><p>We can think of each group as a slice of our <code>DataFrame</code> with only data with values that match. This <code>DataFrane</code> is accessible to use directly using <code>apply</code>, and we can manipulate the data. If we want to select the name of the first wine reviewed from each winery:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;winery&#39;</span>)<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> df : df<span style=color:#f92672>.</span>title<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>0</span>])
</span></span></code></pre></td></tr></table></div></div><p>We can also group more than one column. Let&rsquo;s say we want to pick out the best wine by country and province:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#39;country&#39;</span>, <span style=color:#e6db74>&#39;province&#39;</span>])<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x : x<span style=color:#f92672>.</span>loc[x<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>idmax()])
</span></span></code></pre></td></tr></table></div></div><p>Furthermore, if we want to run a bunch of different functions on the <code>DataFrame</code> at once, we can generate a simple statistical summary of the dataset with <code>agg</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#39;country&#39;</span>])<span style=color:#f92672>.</span>price<span style=color:#f92672>.</span>agg([len, min, max])
</span></span></code></pre></td></tr></table></div></div><h3 id=42-multi-indexes>4.2 Multi-indexes<a hidden class=anchor aria-hidden=true href=#42-multi-indexes>#</a></h3><p>A multi-index example:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>countries_reviewed <span style=color:#f92672>=</span> wine<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#39;country&#39;</span>, <span style=color:#e6db74>&#39;province&#39;</span>])<span style=color:#f92672>.</span>description<span style=color:#f92672>.</span>agg([len])
</span></span><span style=display:flex><span>countries_reviewed
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>| country |     province     | len |
|---------|------------------|-----|
|Argentina| Mendoza Province | 3264|
|         | Other            | 536 |
|...      | ...              |     |
</code></pre><p>If we check the type:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>mi <span style=color:#f92672>=</span> countries_reviewed<span style=color:#f92672>.</span>index
</span></span><span style=display:flex><span>type(mi)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># output</span>
</span></span><span style=display:flex><span><span style=color:#75715e># pandas.core.indexes.multi.MultiIndex</span>
</span></span></code></pre></td></tr></table></div></div><p>There are a few ways to deal with this tiered structure which are absent for single-level indices. To retrieve a value, we need to provide two levels of labels. For the first method, we can convert the index back to the regular index:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>countries_reviewed<span style=color:#f92672>.</span>reset_index()
</span></span></code></pre></td></tr></table></div></div><pre tabindex=0><code>| | country |     province     | len |
|-|---------|------------------|-----|
|0|Argentina| Mendoza Province | 3264|
|1|Argentina| Other            | 536 |
|2|...      | ...              | ... |
</code></pre><h3 id=43-sorting>4.3. Sorting<a hidden class=anchor aria-hidden=true href=#43-sorting>#</a></h3><p>Previously, we learned about the grouping function to group data in index order. But what about in value order? Can we order the rows from the grouping result based on values in the data rather than index?</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>countries_reviewed <span style=color:#f92672>=</span> countries_reviewed<span style=color:#f92672>.</span>reset_index()
</span></span><span style=display:flex><span>countries_reviewed<span style=color:#f92672>.</span>sort_values(by <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;len&#39;</span>)
</span></span></code></pre></td></tr></table></div></div><p>By default, the sorting will be in ascending order, we can change that by changing the <code>ascending</code> parameter:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>countries_reviewed<span style=color:#f92672>.</span>sort_values(by <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;len&#39;</span>, ascending <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>)
</span></span></code></pre></td></tr></table></div></div><p>Moreover, if we just want to sort by index values, simply leave the <code>by</code> parameter blank:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>countries_reviewed<span style=color:#f92672>.</span>sort_values()
</span></span></code></pre></td></tr></table></div></div><p>Of course, we could sort more than one column at a time:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>countries_reviewed<span style=color:#f92672>.</span>sort_values(by <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;country&#39;</span>, <span style=color:#e6db74>&#39;len&#39;</span>])
</span></span></code></pre></td></tr></table></div></div><h2 id=5-data-types--missing-values>5. Data Types & Missing Values<a hidden class=anchor aria-hidden=true href=#5-data-types--missing-values>#</a></h2><p>In this section, we will explore how to investigate data types within a <code>DataFrame</code> and how to replace entries in it.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>price<span style=color:#f92672>.</span>dtype() <span style=color:#75715e># for the specified column</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>wine<span style=color:#f92672>.</span>dtype() <span style=color:#75715e># for all columns</span>
</span></span></code></pre></td></tr></table></div></div><p><code>dtype</code> function tells us how pandas store the data internally such as <code>float64</code> or <code>int64</code>. We can convert a column from one type to the other too:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>astype(<span style=color:#e6db74>&#39;float64&#39;</span>)
</span></span></code></pre></td></tr></table></div></div><h3 id=51-missing-value>5.1 Missing Value<a hidden class=anchor aria-hidden=true href=#51-missing-value>#</a></h3><p>In a dataset, we might see values being given as <code>NaN</code> or &ldquo;not a number&rdquo;. Using Pandas, we can check for the missing data in a <code>DataFrame</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine[pd<span style=color:#f92672>.</span>isnull(wine<span style=color:#f92672>.</span>country)]
</span></span></code></pre></td></tr></table></div></div><p>To replace the missing value in data, we can use the <code>fillna()</code> function:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>region<span style=color:#f92672>.</span>fllna(<span style=color:#e6db74>&#34;Unknown&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>If we want to replace value, here&rsquo;s what we can do:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>twitter_handle<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;@x&#34;</span>, <span style=color:#e6db74>&#34;@abc&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><h2 id=6-renaming--combining>6. Renaming & Combining<a hidden class=anchor aria-hidden=true href=#6-renaming--combining>#</a></h2><p><code>rename</code> is a function to let you change index names or column names:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>rename(column <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;point&#39;</span>: <span style=color:#e6db74>&#39;score&#39;</span>})
</span></span></code></pre></td></tr></table></div></div><p>This function allows us to rename index or column by specifying an index or a column keyword parameter:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>rename(index <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>: <span style=color:#e6db74>&#39;first&#39;</span>, <span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#39;second&#39;</span>})
</span></span></code></pre></td></tr></table></div></div><p>Of course, we could give name to a row index and the column index as well:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>wine<span style=color:#f92672>.</span>rename_axis(<span style=color:#e6db74>&#39;wines&#39;</span>, axis <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;rows&#39;</span>)<span style=color:#f92672>.</span>rename_axis(<span style=color:#e6db74>&#39;fields&#39;</span>, axis <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;columns&#39;</span>)
</span></span></code></pre></td></tr></table></div></div><h3 id=61-combining>6.1 Combining<a hidden class=anchor aria-hidden=true href=#61-combining>#</a></h3><p>The simplest combination method in Pandas is <code>concat</code>. This function is useful when we have data in different <code>DataFrame</code> but having the same columns:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>pd<span style=color:#f92672>.</span>concat([can_yt, bri_yt])
</span></span></code></pre></td></tr></table></div></div><p>Moreover, for <code>join</code>, it will combine different <code>DataFrame</code> which have an index in common:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>left <span style=color:#f92672>=</span> canadian_youtube<span style=color:#f92672>.</span>set_index([<span style=color:#e6db74>&#39;title&#39;</span>, <span style=color:#e6db74>&#39;trending_date&#39;</span>])
</span></span><span style=display:flex><span>right <span style=color:#f92672>=</span> british_youtube<span style=color:#f92672>.</span>set_index([<span style=color:#e6db74>&#39;title&#39;</span>, <span style=color:#e6db74>&#39;trending_date&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>left<span style=color:#f92672>.</span>join(right, lsuffix<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;_CAN&#39;</span>, rsuffix<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;_UK&#39;</span>)
</span></span></code></pre></td></tr></table></div></div><p>For the above example, the <code>lsuffix</code> and <code>rsuffix</code> parameter is necessary because the data has the same columns names in both of the datasets. If it is not, then we could just ignore that.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/pandas/>Pandas</a></li><li><a href=http://localhost:1313/tags/data-frame/>Data Frame</a></li><li><a href=http://localhost:1313/tags/python/>Python</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/2023/2023-08-15-data-visualization/><span class=title>« Bài mới hơn</span><br><span>Data Visualization</span>
</a><a class=next href=http://localhost:1313/posts/2023/2023-08-13-a-streamit-app-for-flood-analysis/><span class=title>Bài cũ hơn »</span><br><span>A Streamlit App For Flood Analysis</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Pandas on x" href="https://x.com/intent/tweet/?text=Pandas&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f&amp;hashtags=Pandas%2cDataFrame%2cPython"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Pandas on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f&amp;title=Pandas&amp;summary=Pandas&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Pandas on reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f&title=Pandas"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Pandas on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Pandas on whatsapp" href="https://api.whatsapp.com/send?text=Pandas%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Pandas on telegram" href="https://telegram.me/share/url?text=Pandas&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Pandas on ycombinator" href="https://news.ycombinator.com/submitlink?t=Pandas&u=http%3a%2f%2flocalhost%3a1313%2fposts%2f2023%2f2023-08-18-pandas%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>The Financial Engineer</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Sao chép";function s(){t.innerHTML="Đã sao chép!",setTimeout(()=>{t.innerHTML="Sao chép"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>